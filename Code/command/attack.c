#include "stdio.h"
#include "string.h"

unsigned char payload[] = {
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38,
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38,
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38,
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38,
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38,
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38,
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38,
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, //64字节
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, //需要多覆盖一行，因为对于64字节的buffer，os会为其补充8字节来缓冲
    0x33, 0x33, 0x33, 0x33, 0x1b, 0x10, 0x00, 0x00, // caller's ebp & return address
};

void vulnerable_function() {
    char buffer[64]; // 声明一个64字节大小的缓冲区
    strcpy(buffer, payload);
}

void mycode() {
    printf("Stack overflow attack succeeded!\n");
}

int main(int argc, char *argv[]) {
    vulnerable_function();
    return 0;
}